<?php

namespace JonathanHunsucker\With\Tests;

use PHPUnit\Framework\TestCase;

use function JonathanHunsucker\With\with;

use JonathanHunsucker\With\Open;

class OpenTest extends TestCase
{
    public function test(): void
    {
        touch("test.txt");
        $file = new Open("test.txt", "w");

        with($file)->do(function ($handle) {
            // this is awful to manipulate files in concurrently run tests, but it'll do for now
            fwrite($handle, "hello");
        });

        $content = file_get_contents("test.txt");
        unlink("test.txt");

        $this->assertEquals($content, "hello");
    }
}
